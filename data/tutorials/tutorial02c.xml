<?xml version="1.0" encoding="UTF-8"?>
<!--
Tutorial 02c - Convert static site into CI webapp
-->
<tutorial status="beta">
    <!-- Activity metadata ... override anything from the course or organizer -->
    
    <!-- The meat of the presentation -->
    <slide title="Tutorial Goals" layout="normal">
        <p>This tutorial will walk you through converting a static HTML
            website into a CodeIgniter webapp.</p>
        <p>Suggestion: you may want to skim the slideshow first,
            before working your way through it.</p>
    </slide>

    <slide title="Get The Starter" layout="normal">
        <div class="left">
            <p>Fork the 
                <a href="https://github.com/comp4711/winter2015-lab02" target="_blank">lab starter</a>
                project, and clone it to your local system.
            </p>
            <p>You can clone it to any folder inside your htdocs, as long as
                you have a virtual host mapping to it for testing.
                I will assume "comp4711.local" for this writeup.</p>
        </div>
        <div class="right">
            <br/>
            <img class="scale" width="600" height="382" src="/data/tutorials/pix/2-31.png"/>
        </div>
    </slide>

    <slide title="What Do You Have?" layout="normal">
        <div class="left">
            <p>I cloned mine to a "my-lab02" project/folder on my system.
                Substitute you choices whenever I refer to my folder.</p>
            <p>You should see a "public" folder, which contains an entire
                static website.</p>            
        </div>
        <div class="right">
            <br/>
            <img class="scale" width="332" height="262" src="/data/tutorials/pix/2-32.png"/>
        </div>
    </slide>

    <slide title="What Does It Look Like?" layout="normal">
        <div class="left">
            <p>Assuming that your new project is mapped to "comp4711.local",
                then the URL "comp4711.local/public" should give you the
                homepage of the static site, shown right.</p>            
        </div>
        <div class="right">
            <br/>
            <img class="scale" width="600" height="306" src="/data/tutorials/pix/2-33.png"/>
        </div>
    </slide>

    <slide title="How Do We Make This Into a Webapp?" layout="normal">
        <div class="left">
            <p>The basic steps we will follow are shown to the right.
            </p>
            <p>This isn't the only way to do this job, but is one
                that makes sense. After each stage of the conversion,
                we should still have a working site.</p>
            <p>Er, it will behave like it is working, even though
                it won't be a proper webapp until we are done.</p>
        </div>
        <div class="right">
            <ol>
                <li>Copy our CI starter into our project</li>
                <li>Do a trivial conversion</li>
                <li>Setup base controller and view template</li>                    
                <li>Fix the pages to use these</li>
                <li>Add a model</li>
                <li>Revisit the pages</li>
            </ol>
        </div>
    </slide>

    <slide title="Copy Our CI Starter" layout="normal">
        <div class="left">
            <p>Copy the contents of your CodeIgniter starter project (from
                tutorial 2B) into your project folder.</p>
            <p>Now, asking for comp4711.local in your browser should
                give you the "Welcome to CodeIgniter!" page.</p>
        </div>
        <div class="right">
            <img class="scale" width="256" height="342" src="/data/tutorials/pix/2-34.png"/>
        </div>
    </slide>

    <slide title="Create Trivial Controllers" layout="normal">
        <div class="left">
            <p>Our static site has 3 pages, index.html, gallery.html
                and about.html. We can make trivial controllers for each of these,
                which simply load the corresponding "view".</p>
            <p>Fix application/controllers/Welcome.php (your homepage)
                to load the "welcome" view. Create similar controllers Gallery.php and About.php,
                which load the "gallery" and "about" views, respectively.</p>
        </div>
        <div class="right">
            <img class="scale" width="416" height="182" src="/data/tutorials/pix/2-35.png"/>
        </div>
    </slide>
    
    <slide title="Create Trivial Views" layout="normal">
        <div class="left">
            <p>We can make trivial views for each of the static pages,
                by copying the static html files to our application/views
                folder, and renaming them to have a ".php" extension.
                Note that index.html would become welcome.php.</p>     
            <p>You may have to rename these using your file manager,
                if your IDE won't let you change the extension.</p>      
            <p>We no longer need the views/welcome_message.php.</p>     
        </div>
        <div class="right">
            <img class="scale" width="318" height="478" src="/data/tutorials/pix/2-36.png"/>
        </div>
    </slide>

    <slide title="We Now Have a Trivial Site" layout="normal">
        <div class="left">
            <p>Checkout your site now, using the comp4711.local URL.</p> 
            <p>Oops, our image links are broken!</p>               
        </div>
        <div class="right">
            <img class="scale" width="600" height="386" src="/data/tutorials/pix/2-37.png"/>
        </div>
    </slide>

    <slide title="Fix Our Image Links" layout="normal">
        <div class="left">
            <p>Examining views/welcome.php, you can see that the image 
                references no longer work. 
                We can solve this by copying/moving those folders up
                one level, alongside "applications".</p>
            <p>A better practice is to keep your "assets" (like these)
                in a separate folder, which could be called "public" or
                "assets". We can address 
                the better practice in a later refactoring.</p>
            <p>For now, let's copy the folders up one level. </p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="295" src="/data/tutorials/pix/2-38.png"/>
        </div>
    </slide>

    <slide title="Fix Our Menu" layout="normal">
        <div class="left">
            <p>Yay, our site *looks* better, but what about the menu? It still
                refers to the original HTML files. Fix this by changing the menu links to refer to our CI controllers
                instead. Apply this change to each of our three views.</p>
            <p>Notice that the homepage is referred to as just "/", and that
                each of the other references start with a slash.</p>
        </div>
        <div class="right">
            <img class="scale" width="505" height="108" src="/data/tutorials/pix/2-39.png"/>
        </div>
    </slide>

    <slide title="Build a Master View Template" layout="normal">
        <div class="left">
            <p>Eliminate duplicate code in our views by extracting
                the common opening and closing HTML into views/template.php.</p>
            <p>Let's do that, and add a placeholder, "{content}", which will
                get substituted appropriately in our next tutorial step.
                Add another placeholder, "{pagetitle}", for the page title.</p>
            <p>I would do this by copying the about view, renaming it
                to "template.php", and then zapping its middle.</p>            
        </div>
        <div class="right">
            <img class="scale" width="600" height="432" src="/data/tutorials/pix/2-40.png"/>
        </div>
    </slide>

    <slide title="Simplify Our Views" layout="normal">
        <div class="left">
            <p>We can now eliminate the common opening and closing HTML
                from our three original views, leaving just the "meat".</p>
            <p>Our revised views/welcome.php is shown to the right.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="285" src="/data/tutorials/pix/2-41.png"/>
        </div>
    </slide>

    <slide title="Is This Better?" layout="normal">
        <div class="left">
            <p>The site still "works", but looks funny without the 
                proper styling :-/</p>
            <p>We will fix that next!</p>                
        </div>
        <div class="right">
            <img class="scale" width="600" height="295" src="/data/tutorials/pix/2-42.png"/>
        </div>
    </slide>

    <slide title="Build a base controller" layout="normal">
        <div class="left">
            <p>We will make a base controller to pull the view pieces
                together consistently, using our template.</p>
            <p>This will be similar to the one referenced in lesson 2,
                from the contacts sample webapp.
                Copy yours from the contacts project to core/MY_Controller.php
                inside your lab 2 project.</p>
            <p>Fix the menu to suit our app, and change the ['title']
                reference to ['pagetitle'], to match what we already setup in 
                our template.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="556" src="/data/tutorials/pix/2-43.png"/>
        </div>
    </slide>
 
    <slide title="Apply our base controller" layout="normal">
        <div class="left">
            <p>Modify our three controllers to extend our base controller,
                Application, instead of CI_Controller. </p>
            <p>In these controllers, instead of $this-&gt;load->view('x')
                we should set a view parameter instead, and invoke the
                render method of the base controller.</p>
            <p>$this-&gt;data['pagebody'] = 'x'; $this-&gt;render();</p>
        </div>
        <div class="right">
            <img class="scale" width="389" height="240" src="/data/tutorials/pix/2-44.png"/>
        </div>
    </slide>
 
    <slide title="What Do You Think Now?" layout="normal">
        <div class="left">
            <p>We also need to copy the common_helper
                from the contacts starter, so we can use its build_menu function.</p>
            <p>We should autoload the common and url helpers, and the parser library,
                since they are used in Application.
            </p>
            <p>Looking better, although the
                image references are still hard-coded.
                We'll fix that next.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="285" src="/data/tutorials/pix/2-45.png"/>
        </div>
    </slide>
 
    <slide title="Add a model" layout="normal">
        <div class="left">
            <p>We already have a SQL script in the data/setup folder of our starter.
            How convenient! It's like someone planned to use a database eventually :-/</p>
            <p></p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="283" src="/data/tutorials/pix/2-37.png"/>
        </div>
    </slide>

    <slide title="Revisit the gallery page" layout="normal">
        <div class="left">
            <p>Let's see. Replace the contents of the folder you have 
                comp4711.local mapped to, with the contents of the
                starter folder you just made.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="283" src="/data/tutorials/pix/2-37.png"/>
        </div>
    </slide>

    <slide title="Revisit the homepage" layout="normal">
        <div class="left">
            <p>Let's see. Replace the contents of the folder you have 
                comp4711.local mapped to, with the contents of the
                starter folder you just made.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="283" src="/data/tutorials/pix/2-37.png"/>
        </div>
    </slide>

    <slide title="Are We There Yet?" layout="normal">
        <div class="left">
            <p>Let's see. Replace the contents of the folder you have 
                comp4711.local mapped to, with the contents of the
                starter folder you just made.</p>
        </div>
        <div class="right">
            <img class="scale" width="600" height="283" src="/data/tutorials/pix/2-37.png"/>
        </div>
    </slide>

   
</tutorial>
